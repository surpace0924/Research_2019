\input{./setting.tex}
\begin{document}

\begin{abstract}
　本研究は、車両と歩行者との衝突を回避するための自動減速システムの実現を目的としている。提案システムは現在位置から歩行者の将来位置を予測し、衝突確率を検出することができる。さらに、駆動抵抗やモデリング誤差を補償することができるモデル予測制御を採用したコントローラも提案されている。提案した方法の有効性をシミュレーションと実験を通して検証した。
\end{abstract}

\maketitle
\pagestyle{fancy}

\section{前書き}
　車両制御技術は、情報処理の先端技術として急速に発展している。たとえば、急ブレーキ時にホイールロックを防止するアンチロックブレーキシステム（ABS）、滑りやすい路面でタイヤがスリップするのを抑制する電子安定性制御（ESC）（1）。また、各車輪の駆動力を独立して制御して車両の挙動を安定させるダイレクトヨーモーメント制御（DYC）と、駆動力を制御することで所望のスリップ率を維持するスリップ率制御（2）（3）。このような制御技術の発展により、自動車はこれまで以上に安全かつ安定して走行することが可能になってきた。運転支援システムは、交通事故件数の削減に大きく貢献し、さらなる発展が期待されている。\\
　近年、交通事故を減らす技術として自律型緊急ブレーキシステム（AEBS）が注目されている。AEBSの概要：車両に搭載されたカメラやレーダーが他の車両や前方の歩行者などの障害物を検出した場合、相対位置と相対速度から衝突の危険性を判断する。すると，システムは車両を減速させる。自動車製造業者の調査によると、事故の合計数は、非装備車と比較して61％減少し、後端事故の数は84％減少した（4）。それはAEBSの重要性と有用性を証明している。\\
　しかしながら、現在の商用車のAEBSは、歩行者の現在位置に基づいて衝突の危険性を検出しており、歩行者の動きを考慮していないという問題がある。歩行者や障害物が車両の前方に存在する場合、システムはそれに対処することができ、衝突事故を回避することが可能である。一方、歩行者が横から歩くと、衝突の瞬間まで歩行者が車両の前に位置していないため、現在のAEBSは機能しない可能性がある。歩行者と車両との衝突事故は道路を横断する間にしばしば起こるので、歩行者運動に対応するAEBSは交通事故を減らすための重要なシステムである。\\
　歩行者の動きに対応して、歩行者の将来の位置を予測し、それに応じて制動力を制御する必要がある。したがって、有限時間における車両の位置がシステムの指令値となるように、時間領域で車両を制御する必要がある。\\
　そこで，時間領域での制御器設計法としてモデル予測制御（MPC）が注目されている。MPCは制約条件付きリアルタイム最適制御と呼ぶことができ、将来のシステム挙動を予測し、評価関数 (5) を最小化するように現在の入力値を決定する。MPCは二次計画問題を解決する必要があり,計算負荷が大きいため,プロセス制御の分野のようにサンプリング時間の長いシステムで広く使用されている。しかし,近年,計算機の計算速度が向上してきており,サンプリング時間の短いシステムへの適用が可能になってきている。MPCのもう一つの問題は,開ループコントローラである。制御性能はモデル精度に大きく依存し,外乱の感度が高いという欠点がある。\\
　外乱抑制と目標値への追従性を両立させるためには、外乱を推定しフィードフォワード制御で補償する必要がある。外乱とは、転がり抵抗、空気抵抗、坂道走行時に発生する勾配抵抗などの走行抵抗のことである。しかしながら、駆動力制御に関するこれまでの研究のほとんどは、駆動抵抗が非常に小さいと仮定し無視している（6）。サンプリング時間が短いシステムの場合、フィードバックループによる駆動抵抗の影響を少なくすることができる。しかしながら、MPCはPID制御等よりもサンプリング時間が長く、外乱の影響が顕著になる。さらに、外乱はMPCにおける予測に使用されるモデルの精度を低下させるので、自動車の予測された挙動は実際のものから逸脱する。これでは所望の結果が得られない。したがって、MPCを駆動力制御に適用するためには、駆動抵抗の推定と補償を考慮する必要がある。\\
　一般に、人間はさまざまな道路環境や歩行者に基づいて危険を予測しながら運転する。ここでは、人間などの危険性を予測しながら車両を制御することを目的としており、歩行者の動きに対応するためのAEBSの改良につながる。この目的を達成するために、歩行者の将来の位置を予測するためのアルゴリズムの構築と運転抵抗を補償することができる時間領域におけるコントローラの設計について述べる。\\
　本論文では、車両に搭載されたカメラなどのセンシング機器から得られる歩行者の位置情報を想定している。提案手法の概要は以下の通りである。まず、歩行者速度は、現在の歩行者の位置からカルマンフィルタによって推定される。将来の歩行者の予測位置は、一定期間の歩行者速度の値から予測される。衝突の可能性がある場合は、車両の予測位置と比較してMPCにより制動力の指令値を算出する。 MPCはモデルの精度に依存するため、外乱とパラメータ誤差の影響を強く受けるという欠点がある。そこで、制御性能を向上させるために制動力のフィードバックループを導入し、外乱である駆動抵抗の推定量を提案システムに含める。システムのコントローラはMPCと制動力フィードバック制御のカスケードコントローラである。提案した方法を利用することにより、歩行者の将来の位置を予測し、衝突の危険性を検出することが可能である。さらに、駆動抵抗を補償して制動力を制御することで、外乱感度を低下させながらシステムの追従性を向上させることができる。\\
　この論文は以下のように構成されている。 2章では提案手法のモデル化について説明し、3章で制御系の設計について述べる．4章と5章ではそれぞれシミュレーションと実験について説明する。最後に、結論は6章に示す。\\

\section{モデリング}
\subsection{車体モデル}
　車両と歩行者との衝突はまっすぐな道路上で起こることがほとんどであり、モデルを単純化するために直線運動のみを考慮した車両の車体モデルを図1に示す。\\
% \begin{figure}[]
%     \centering
%     \includegraphics[height=5cm]{./fig/1.png}
%     \caption{車両の車体モデル}
%   \end{figure}
　図1に示すように、車両の車体の運動学とダイナミクスは次のとおり。\\


　ここで $x$ と $y$ は車両の位置である． $v$、$\theta$、$M$、$n$、$F_d$、$F_r$ は、それぞれ車速、車両角度、車両質量、制御輪数、駆動力、駆動抵抗である。$\Sigma Ｗ$ はワールド座標系を表す。したがって、$\Sigma Ｗ$ の $x$ と $y$ は、それぞれ緯度と経度の位置を示す。一般的に、抵抗力は移動方向に対して反対方向を向いている。ただし、駆動抵抗は正の値でも負の値でも構わない。この論文では、$F_r$ は $F_d$ と同じ方向を向いている。\\
　ちなみに、本論文の制御法にはモデル予測制御（MPC）を含んでおり、MPCは離散状態で定式化される。したがって、車体モデルの線形移動のみを制限した離散時間状態空間表現は、次のように表される．\\



ここで $T_s$ はサンプリング時間を表している。 $u[k]$ は各車輪の力の合計であり、システムの出力変数は状態変数に等しい。 これは， $x$、$y$、$v$に関する情報を取得できることを示している。日本では準天頂衛星システム（QZSS）などの測位技術の開発により、車両の位置を高精度に計測できるため、論文はこれらの値が得られると仮定している（7）。

\subsection{ホイールモデル}
図2に示すホイールモデルのダイナミクスは次のように説明されます。

ここで、J、Tm、ω、rw、λ、およびμは、それぞれモーターの慣性、モーターまたはブレーキ装置によって生成されるトルク、車輪角速度、車輪半径、スリップ率、および摩擦係数を表します。 μはスリップ率λの関数であり、μは法線力とタイヤ力の比を示していることに注意してください。

\subsection{摩擦円}
摩擦円理論によれば，縦力Fxと横力Fyを含むタイヤ力は，式（9）となる．

μmaxは最大摩擦係数を示し、gは重力加速度です。式（9）は、縦力と横力の合力に上限があることを示しています。その場合、合力は式の右側を超えます。 （9）タイヤがスリップし、ドライバーは車両を制御できません。したがって、スリップ現象を回避するためにタイヤの力を制御する必要があります。

\section{制御システム設計}
　このセクションでは、2つのセクションから構成される提案された制御システムについて説明します。 1つは衝突検出の一部であり、もう1つはブレーキシステムです。

\subsection{衝突検出}
　歩行者と車両の衝突を検出するために，最初にカルマンフィルターを使用して歩行者の速度を推定します．状態空間表現と推定方程式は次のように説明されます．

　ここで，ω，ν，およびg[k]は，それぞれシステムノイズ，観測ノイズ，および最適なカルマンゲインを示します． ωとνはホワイトノイズであることに注意してください． xhおよびyhは，カメラデバイスまたは道路機器によって取得される歩行者の位置です．カルマンフィルターを使用すると，歩行者の速度を推定できます．
　次に，有限時間における歩行者の位置が歩行者の速度から予測されます．一定期間の歩行者の速度は2次正規分布に従うと想定されます．これにより，確率密度関数が一定の場合，等確率楕円が作成されます．等確率楕円の方程式は次のとおりです．

　ここで，μxとμyは平均値，σx、σyは標準偏差，σxyは歩行者の速度の共分散です．さらに，αは等確率楕円の角度を示します． cは確率密度関数fに依存し，cとfの関係を表1に示します．したがって，式（13）は1秒での歩行者の予測位置を示します．一方，入力なしの車両の予測位置は次のように定式化されます．

　i = 1,2、...、Hp、およびHpは予測期間です。次に、衝突検出について説明します。車両と歩行者が衝突する可能性があるかどうかは、以下の式を計算することで確認できます。

　Rhとτは、それぞれ歩行者の安全ゾーンの半径と計算のむだ時間を示します。 xhとyhは歩行者の現在位置、μxとμyは一定期間内の歩行者の速度の平均です。 Dが1未満の場合、車両は歩行者の予測位置にあるため、衝突を避けるために減速する必要があります。車両停止位置の指令値は、次のようにxとyの連立方程式を解くことによって決定されます。

　icは、式（15）のD≤1を満たす最小のiです。車両の現在位置により近い解が衝突回避の制限停止位置として採用され、icTsのコマンド停止点は制限位置から一定の距離にある位置です。図3に、衝突検出のプロセスの概要を示します。

\subsection{ブレーキコントロールシステム}
　モデル予測制御（MPC）は、車両を減速してicTsの停止位置で停止するために使用されます。 MPCは、入力を最適化すると同時に、いくつかの制約を使用して各時点で将来の応答を予測する制御方法です（5）。評価関数は次のとおりです。

　Huは制御範囲です。 QおよびRの説明は次のとおりです。

　ここで、Hwは入力デッドタイムを示すウィンドウパラメーターです。 QとRは、それぞれ出力誤差と入力変化の重み行列を示します。（17）式の右側の第一項はコマンド値からの誤差を減らす効果があり、2番目の項は入力の突然の変化を抑制します。 r[k + i]は次のように決定されます。

　式（18）は、icTs [秒]以降の車両位置を示します。ちなみに、出力と入力の変更と入力の制約は次のとおりです。

　式（19）〜（20）は、コマンドの停止点を超えて実行されないための役割です。 （21）は、入力の変化がチューニングパラメーターであるΔumaxより小さいことを示します。 式（22）は、タイヤの力を、摩擦円理論で決定される最大制動力よりも小さくします。 式の最小化 （17）式に示す制約の下。 （19）〜（22）、最適な入力変化Δu[k | k]が計算されます。 したがって、各車輪の最適な制動力は次のように決定されます。

　したがって、MPCは、モデリングエラーを補正するためにフィードバックループが必要な開ループコントローラーです。 したがって、MPCの内部でタイヤ力のフィードバックループを提供することが提案されています。 したがって、ブレーキ装置によって生成される基準トルクは次のように決定されます。

　ここで、KiおよびFˆdはそれぞれ、積分ゲイン、および駆動力オブザーバー（DFOB）によるタイヤ力の推定値を示します。

\subsection{オブザーバー設計}
　このセクションでは、タイヤの力と走行抵抗を推定する方法について説明します。 タイヤの力を推定するために、駆動力オブザーバー（DFOB）が使用されます（12）。 DFOBは、外乱トルクを正確に推定できる外乱オブザーバー（DOB）に基づいています（11）。 DFOBは次のように定式化されます。

　ここで、gcutはローパスフィルター（LPF）のカットオフ周波数を示します。 DFOBのブロック図を図4に示します。 制御性能を向上させるには、駆動抵抗Frを推定する必要があり、式（26）を使用して推定できます。 走行抵抗推定器のブロック図を図5に示します。

　aは車両の縦加速度です。 μは式（7）で推定でき、λは式（8）で計算されます。 λとμを連続して取得して、最大摩擦係数μmaxは、最小二乗法（LSM）を使用してμ-λcurveを2次関数に近似することによって推定され、式のMPCの制約としてμmaxを設定します。 （22）。
　最後に、ブレーキシステム全体を図6に示します。

\section{シミュレーション}
\subsection{シミュレーション環境}
　提案手法の有効性を検証するために、シミュレーションを実施しました。 シナリオは、図7に示すように、歩行者が横から出て、車両の前に到着すると停止するというものでした。Nは正規分布を表すため、平均速度で歩行する歩行者は1.0 m / secであり、 標準偏差は0.5 m /秒です。 シミュレーションは、表2に示す2種類の道路環境で実行されました。
　このシミュレーションでは、路面を再現するマジックフォーミュラタイヤモデルを使用しました（13）。 駆動抵抗は、転がり抵抗、空気抵抗、勾配抵抗で構成されます。 各力は式で定式化されます。 （27）–（30）。

　シミュレーションパラメータを表3に示します。シミュレーション1では、道路環境1での走行時に走行抵抗が補正されるかどうかの比較が行われます。さらに、道路環境2では路面での最大摩擦係数の推定の有無について比較が行われます。

\subsection{シミュレーション結果}
　シミュレーション1の結果を図4と図5に示します。 8–10。 図8は、車両と歩行者の位置を示しています。 図8によると、システムは良好に機能し、車両は運転抵抗を補償することで歩行者の前方に停止しました。 走行抵抗補正がない場合、車両は歩行者の前で停止できませんでした。 したがって、駆動抵抗を補償することが検証されます。

　また、図9は、推定値と駆動抵抗の真値との比較を示しており、値が真値に近づいたことを示しています。図10から提案手法で適切な制動力が発生していることを確認する。補償付き制御法を利用する場合は、駆動力を考慮した制動力を車両に追加する。道路環境1は下り坂であり、走行抵抗には正の勾配抵抗が含まれます。したがって、コマンドポイントを停止するには、車両を強くブレーキする必要があります。同様に、シミュレーション2の結果を図3と図4に示します。 11–13。
　図11は、車両と歩行者の位置を示しています。図11によれば、路面が濡れていても最大摩擦係数を推定することにより、車両は歩行者の前方を停止しました。図12は最大摩擦係数の推定結果を示しており、推定値が真の値よりわずかに小さい値に収束したことを示しています。図10から提案手法で適切な制動力が発生することが確認された。最大摩擦係数を推定しない場合、タイヤ力の絶対値は2.4秒から減少しました。これは、制動力が摩擦円理論の制限を超え、タイヤがスリップしたことを示しています。したがって、推定最大摩擦係数に対する有効性が確認された。

\section{実験}
　実験は、提案された方法の有効性を確保するために実施されました。 実験では、図14に示すように、ZMP Inc.が作成した1:10スケールの車両モデルであるRoboCar 1/10を使用しました。このモデルには速度コントローラーが含まれ、車両システムの入力は速度のみです。 そのため、MPCから取得した速度値を入力に使用し、駆動力フィードバックの代わりに車両速度フィードバックを実装しました。 実験のブロック図を図15に示します。表4は実験のセットアップを示し、実験手順は次のとおりです。

ステップ1：PCは仮想歩行者の位置を生成します
ステップ2：PCは情報を車両に送信します
ステップ3：車両は歩行者の位置を受け取り、制御を実行します

歩行者の位置は、図16に従ってPCによって計算されました。

実験結果を図17、18に示します。図17は、車両と歩行者の位置を示しています。 車両は歩行者の前の指令停止地点近くで停止しました。 それは、提案した方法が衝突回避システムとして非常にうまく機能することを示した。 図18によれば、走行抵抗推定器は定常値に収束します。 ただし、シミュレーション結果と比較して、駆動抵抗は駆動力よりもはるかに大きかった。 この現象は、転がり抵抗が大きいタイヤが原因で発生したため、制動力を適切に制御して、車両を指令停止点で停止させる必要があります。 補償なしのブレーキシステムの場合、ブレーキ力は変動しました。 その理由は、外乱とMPCが車両の状態を正確に予測できなかったため、運転抵抗がシステムに影響を与えたためです。 以上より、提案手法の有効性は実験により確認された。

\section{結論}
　本稿の目的は，歩行者との衝突を回避するために，自動減速システムを実現することです．提案システムは，現在の位置から歩行者の将来の位置を予測し，衝突確率を検出することができます．また，走行抵抗とモデル化誤差を補償することができるMPCとコントローラは，この論文で提案されています．
　次がように提案した方法の概要です．まず，歩行者の速度は，カルマンフィルターにより，現在の歩行者の位置から推定されます．将来の歩行者の予想位置は，歩行者の速度から予測され，制動力の指令値は，MPCによって計算されます．ここでは、MPCは外乱とパラメータ誤差の影響を強く受けるため、制御性能を向上させるために、制動力のフィードバックループが提案されています。さらに、提案されたシステムには、走行抵抗の推定量が含まれています。提案された方法を利用することにより、歩行者の将来の位置を予測し、衝突の危険性を検出することが可能です。さらに、駆動抵抗を補償し、制動力を制御することにより、外乱感度を低減しながらシステムの追従性を向上させることができます。
　提案手法の有効性は、シミュレーションと実験により検証されています。このシステムを活用して、事故の数を減らすことが期待されます。




\end{document}
